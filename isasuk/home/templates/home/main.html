{% extends 'index.html' %}
{% load getfiletype %}
{% load getstate %}
{% load getgroupname %}
{% load timeformatters %}

{% block navigation %}
    {% include 'navigation.html' %}
{% endblock%}

{% block content %}
<div class='row'>
    <div class='col-md-3'>
        <h4>Najbližšie zasadnutia</h4>
        <ul class="nav nav-pills nav-stacked">
          {% for meeting in meetings %}
            <li role="presentation"
            {% if meeting.id.hex == id %}
              class='active'
            {% endif %}
            >
              <a href="/home/{{ meeting.id.hex }}">
                <h4>{{ meeting.title }}</h4>
                <h5>{{ meeting.group|getgroupname }}</h5>
                <h5>{{ meeting.date|getdate }}</h5>
              </a>
            </li>
          {% endfor %}
        </ul>
    </div>
    <div class='col-md-9'>
      <div>
        <h4>Dokumenty k zasadnutiu</h4>
           <a target='_blank' href='/viewer/file/{{ selected_meeting.program.id.hex }}'>
               Program
           </a><br>
           <a target='_blank' href='/viewer/file/{{ selected_meeting.invitation.id.hex }}'>
               Pozvánka
           </a>
          <ol>
          {% for document in meeting_materials %}
            <li>
             <div class="row">
              <div class="col-md-5">
                <strong>{{ document.proposal.name }}</strong><br>
                {{ document.proposal.creator.last_name }} {{ document.proposal.creator.first_name }}<br>
               {{ document.proposal.timestamp }} 
              </div>
              <div class="col-md-5">
                 {% if document.files.proposal %}
                  {{ document.files.proposal.file_type|getfiletype }}<br>
                  <a href='/viewer/{{document.proposal.id.hex}}/{{document.files.proposal.id.hex}}'>{{ document.files.proposal.name }}</a><br>
                {% endif %}
                {% if document.files.own_material %}
                  {{ document.files.own_material.file_type|getfiletype }}<br>
                  <a href='/viewer/{{document.proposal.id.hex}}/{{document.files.own_material.id.hex}}'>{{ document.files.own_material.name }}</a><br>
                {% endif %}
                {% if document.files.docs %}
                  {{ document.files.docs.0.file_type|getfiletype }}<br>
                  {% for f in document.files.docs %}
                    <a href='/viewer/{{document.proposal.id.hex}}/{{f.id.hex}}'>{{ f.name }}</a><br>
                  {% endfor %}
                {% endif %}
                {% if document.files.attachment %}
                  {{ document.files.attachment.0.file_type|getfiletype }}<br>
                  {% for f in document.files.attachment %}
                    <a href='/viewer/{{document.proposal.id.hex}}/{{f.id.hex}}'>{{ f.name }}</a><br>
                  {% endfor %}
                {% endif %}
              </div>
              <div class="col-md-2">
                  <a class='btn btn-success' href='/viewer/{{document.proposal.id.hex}}/'><i class="fa fa-search"></i></a>
                  <a class='btn btn-success' href='/upload/download/zip/{{document.proposal.id.hex}}'><i class="fa fa-download"></i></a>
              </div>
            </div>
          </li>
          <hr>
          {% empty %}
            K tomuto zasadnutiu ešte niesú žiadne návrhy
          {% endfor %}
        </ol>
      </div>
        
      <div>
      <h4>Moje materiály</h4>
         <div>
             {% if documents %}
               <table class="table">
                 <thead>
                   <tr>
                     <td>
                       Názov návrhu
                     </td>
                     <td>
                       Stav
                     </td>
                     <td>
                     </td>
                     </tr>
                   </tr>
                 </thead>
                 <tbody>
               {% for proposal in documents %}
                   <tr>
                     <td>
                      {{ proposal.proposal.name }}
                     </td>
                     <td>
                       {{ proposal.proposal.state|getstate }}
                     </td>
                     <td>
                        <a class='btn btn-success' href='/viewer/{{proposal.proposal.id.hex}}/'><i class="fa fa-search"></i></a>
                     </td>
                   </tr>
               {% endfor %}
                 </tbody>
               </table>
             {% else %}
               <p>V súčasnosti nemáte žiadne návrhy.</p>
             {% endif %}
             </div>
      </div>
    </div>
</div>
{% endblock %}

{% block footer %}
    {% include 'footer.html' %}
{% endblock %}
